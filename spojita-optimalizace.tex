%!TEX root = main.tex

Mnoho optimalizaèních problémù z bì¾ného ¾ivota se dá definovat jako optimalizace funkce $$f: D \to \Real\,,$$ kde $D \subseteq \Real^d$. Je proto pøirozené, ¾e mnoho výzkumníkù se zabývá právì evoluèními algoritmy, kterou jsou schopné optimalizovat takové funkce. Problém optimalizace takových funkcí se v literatuøe objevuje pod pojmem \emph{spojitá optimalizace}\footnote{anglicky \emph{continuous optimization}}. Je dùle¾ité si uvìdomit, ¾e název
 vyjadøuje pouze to, ¾e prostor, ve kterém se hledají øe¹ení je spojitý ($\Real^n$), samotná optimalizovaná funkce $f$ být spojitá nemusí.

Velmi èasto je definièní obor funkce $D$ $d$-rozmìrný interval $$D = [l_1, u_1] \times \dots \times [l_d, u_d]\,,$$ kde $l_i$ a $u_i$ jsou dolní a horní meze pro $i$-tou promìnnou. Objevují se ale i obecnìj¹í problémy, kde je $D$ dána pomocí mno¾iny podmínek tvaru $g(\vec{x}) \leq 0$ a $h(\vec{x}) = 0$, pro $g, h: \Real^d \to \Real$.

V této kapitole napøed budeme uva¾ovat optimalizaèní problém tvaru 
\begin{equation*}
  \begin{aligned}
  & \underset{x}{\text{min}} & & f(\vec{x}) \\
  & \text{za podmínek} & & \vec{x} \in [l_1, u_1] \times \dots \times [l_d, u_d]\,. \\
  \end{aligned}
\end{equation*}

\section{Vlastnosti funkcí}

Je zøejmé, ¾e nìkteré typy funkcí budou pro evoluèní algoritmy lehèí, ne¾ jiné. Velký vliv na efektivitu evoluèního algoritmu mají pøedev¹ím vlastnosti jako multi-modalita, separabilita a podmínìnost. 

Funkce je \emph{multi-modální}, pokud má velké mno¾ství lokálních optim. Je zøejmé, ¾e v takovém pøípadì mù¾e mít algoritmus problém s uváznutím v lokálním optimu a je potøeba tomu pøizpùsobit operátory. Existuje i oblast multi-modální optimalizace, kde je cílem najít co nejvíce rùznorodých lokálních optim. 

Separabilní funkce jsou naopak pro optimalizaci jednodu¹¹í. Jsou to takové funkce, které se dají zapsat pomocí funkcí jedné promìnné. Formálnì, funkce $f(x_1, \dots, x_n): \Real^n \to \Real$ je \emph{aditivnì separabilní}, pokud se dá zapsat jako souèet funkcí $f_1(x_1), \dots, f_n(x_n)$, tj. $f(x_1, \dots, x_n)= \sum_{i=1}^n f(x_i)\,.$ Obdobnì mù¾eme zadefinovat i funkci multiplikativnì separabilní. Z hlediska optimalizace je velkou výhodou separabilních funkcí, ¾e se dají optimalizovat po jednotlivých slo¾kách vektoru, tj. optimum mù¾eme najít tak, ¾e v¾dy zafixujeme hodnoty $n-1$ parametrù a optimalizujeme jen podle jednoho.

Dal¹í vlastností, které výraznì ovlivòuje evoluci je podmínìnost funkce. Ta vyjadøuje, jak moc se li¹í vliv jednotlivých promìnných na hodnotu funkce. Pro kvadratické funkce (u kterých vrstevnice vypadají jako elipsoidy), je jejich podmínìnost druhá odmocnina pomìru mezi délkou nejdel¹í a nejkrat¹í osy elipsoidu. Pokud je podmínìnost funkce velká, øíká se, ¾e je funkce ¹patnì podmínìná. Z hlediska evoluèního algoritmu je dùle¾ité, ¾e by s rùzným vlivem promìnných na hodnotu funkce mìly poèítat operátory.

\begin{marginfigure}
\centering
\input{graphics/tikz/funkce}
\caption{Pøíklady rùzných vlastností funkcí}
\label{fig:function_examples}
\end{marginfigure}

Pøíklady posledních dvou vlastností vidíme na obrázku \ref{fig:function_examples}, který ukazuje vrstevnice funkcí dvou promìnných. Horní funkce je jednoduchý dvoudimenzionální paraboloid, který je separabilní a dobøe podmínìný. Na prostøedním obrázku je paraboloid, který má jednu osu del¹í ne¾ druhou a znázoròuje tedy ¹patnou podmínìnost\footnote{podmínìnost zobrazené funkce jen cca 4.8, nedá se tedy pova¾ovat za ¹patnì podmínìnou, objevují se i funkce s podmínìností $10^6$}. Poslední funkce potom kombinuje ¹patnou podmínìnost s neseparabilitou.

Vý¹e uvedené vlastnosti jsou ty, které nejvíce ovlivòují efektivitu evoluèních algoritmù pøi spojité optimalizaci, nejsou to ale v¹echny. Nìkteré algoritmy napøíklad mohou vyu¾ívat rùzné symetrie dané funkce, naopak funkce, které mají své globální optimum jen ve velmi malé oblasti prohledávaného prostoru a jinak jsou konstantní jsou pro evoluci velmi tì¾ké obecnì.

\section{Kódování pro spojitou optimalizaci}

Jedno z prvních rozhodnutí, které je potøeba udìlat pøi návrhu evoluèního algoritmu je výbìr kódování jedince. Vzhledem k tomu, ¾e ve spojité optimalizaci pracujeme s vektory reálných èísel, je otázka výbìru kódování relativnì snadná a jedinci jsou v naprosté vìt¹inì pøípadù kódování jako vektor typu \code{float} nebo \code{double}.


\ask{Existuje pro tohle $\downarrow$ nìjaká reference?}

Dalo by se uva¾ovat i o kódování jedince pøímo po vzoru Hollandova genetického algoritmu, tj. binárním vektorem, a pou¾ívat jednoduchá $n$-bodová køí¾ení a bit-flip mutace, ale taková reprezentace trpí tím, ¾e zmìna rùzných bitù v èíslech vede k výraznì rùzným zmìnám hodnoty (napø. zmìna bitu na konci mantisy vs. zmìna bitu na zaèátku exponentu).

\section{Operátory pro spojitou optimalizaci}

Pro spojitou optimalizaci mù¾eme samozøejmì pou¾ít stejné operátory jako pro ka¾dé jiné vektorové kódování jedince, tedy napøíklad $n$-bodové, pøípadnì uniformní køí¾ení. Nicménì èastìji se pou¾ívají operátory specializované, které pøímo vyu¾ívají toho, ¾e jedinci jsou vektory èísel.

Tzv. aritmetické køí¾ení vektorù poèítá vá¾ený prùmìr dvou rodièù tak, aby vytvoøilo potomka, potomci se tedy spoèítají jako
\begin{align*}
o_1 & = w*p_1 + (1-w)* p_2\,, \\
o_2 & = (1-w)*p_1 + w* p_2\,,
\end{align*}
kde $p_1$ a $p_2$ jsou rodièe a $w \in (0,1)$ je (pøípadnì náhodnì) zvolená váha. Aèkoliv se takové køí¾ení relativnì èasto pou¾ívá hlavnì v jednodu¹¹ích aplikacích, jeho velkou nevýhodou je, ¾e výslední potomci se nikdy nemohou dostat z konvexního obalu poèáteèní populace.

Mutace pro spojitou optimalizaci se obèas rozdìlují na dva typy --- ovlivnìné a neovlivnìné. Neovlivnìná mutace generuje novou hodnotu pro slo¾ku vektoru nezávisle na aktuální hodnotì, ovlivnìná mutace naopak aktuální hodnotu pou¾ívá. Typickým pøíkladem neovlivnìné mutace je vygenerování nového èísla z daného rozsahu. Ovlivnìná mutace typicky pøièítá k dané slo¾ce vektoru èíslo z normálního rozdìlení $\normal{\mu}{\sigma^2}$.

Jednou z nevýhod vý¹e uvedeného aritmetického køí¾ení je, ¾e potomci jsou velmi èasto relativnì daleko od svých rodièù a nejsou jim tedy moc podobní. Právì z toho dùvodu Deb a Agrawal navrhli simulované binární køí¾ení (SBX)\cite{agrawal1995simulated}. Hlavní inspirací pro vytvoøení SBX bylo jednobodové køí¾ená binárních øetìzcù, které reprezentují èísla ve dvojkové soustavì. Pøi náhodné volbì bodu pro køí¾ení velká èást nových potomkù je relativnì blízko k jednomu z rodièù. Jednobodové køí¾ení má navíc dal¹í pìknou vlastnost -- oba potomci jsou stejnì daleko od prùmìru rodièù. 

Cílem SBX je právì simulovat velikosti zmìn, které se dìjí pøi jednobodovém køí¾ení binárních øetìzcù. Noví potomci se v SBX køí¾ení spoèítají jako 
$$o_{1,2} = \frac{1}{2}(p_1 + p_2) \pm \frac{1}{2}\beta(p_2 - p_1)\,,$$ kde $p_1$ a $p_2$ jsou rodièe a $\beta$ je náhodné èíslo s pravdìpodobnostním rozdìlením
$$P(\beta) = \twopartdef{\frac{1}{2} (n+1) \beta^n}{\beta \leq 1}
                        {\frac{1}{2} (n+1) \frac{1}{\beta^{n+2}}}{\beta>1\,,}$$
kde $n$ je parametr rozdìlení, který urèuje, jak èasto budou hodnoty $\beta$ blízko $1$. Pro vy¹¹í hodnoty $n$ je tato pravdìpodobnost vy¹¹í (viz Obrázek~\ref{fig:sbx_beta}). 

\begin{marginfigure}[-12\baselineskip]
\centering
\input{graphics/tikz/sbx.tex}
\caption{Distribuce $\beta$ v SBX køí¾ení pro $n=2$ a $n=10\,.$}
\label{fig:sbx_beta}
\end{marginfigure}

Podobnou motivaci jako SBX má i tzv. \emph{polynimální mutace} (PM)\cite{Deb96acombined}. V tomto pøípadì se simuluje velikost zmìn v bit-flip mutaci binárnì kódovaných èísel. To znamená, ¾e novì vytvoøený jedinec je s velkou pravdìpodobností blízko svému rodièi. Gaussovská mutace se chová podobnì, ale u PM je pravdìpodobnost malých zmìn mnohem vìt¹í. Nový jedinec se v polynomiální mutaci vytvoøí jako 
$$o = p + \delta \Delta_{max}\,$$ kde $\Delta_{max}$ je maximální velikost mutace a $\delta$ je náhodné èíslo z rozdìlení $$P(\delta) = \frac{1}{2}(n+1)(1-|\delta|)^n\,, \quad \delta \in (-1, 1)\,.$$ Promìnná $n$ má v tomto pøípadì podobný význam jako u SBX a urèuje tvar distribuce. Opìt vìt¹í hodnota $n$ vede k vìt¹í pravdìpodobnosti men¹ích zmìn.

\begin{marginfigure}[-10\baselineskip]
\centering
\input{graphics/tikz/pm}
\caption{Pravdìpodobnostní rozdìlení $\delta$ v polynomiální mutaci pro $n=2$ a $n=10\,.$}
\end{marginfigure}

\section{Diferenciální evoluce}

V¹echny vý¹e popsané operátory mají jednu zásadní nevýhodu a tou je, ¾e operují s jedinci po slo¾kách, jsou tedy vhodné pøedev¹ím pro separabilní funkce. \emph{Diferenciální evoluce}\cite{Storn1997} pøiná¹í jiný pøístup, který tímto problémem netrpí. 

V diferenciální evoluci se jedinec vytváøí pomocí jediného operátoru, který v sobì kombinuje jak mutaci, tak køí¾ení. Jeho vstupem jsou hned ètyøi jedinci z populace rodièù. Jako rodiè $p_4$ se vìt¹inou volí postupnì v¹ichni jedinci z populace (není tedy volen náhodnì), dal¹í tøi rodièe jsou zvoleny náhodnì. Nový jedinec vzniká tak, ¾e se k rodièi $p_3$ pøiète rozdíl rodièù $p_2$ a $p_3$ a potom se provede køí¾ení s rodièem $p_4$. Postup se dá zapsat jako 
$$o^i = \twopartdefotherwise{p_3^i + F(p_1^i-p_2^i)}{r^i < CR \text{ nebo } i = R}
                   {p_4^i}{\,,}$$
kde $F$ a $CR$ jsou parametry mutace a køí¾ení, $r_i$ je náhodné èíslo z rovnomìrného rozdìlení $\uniform{0}{1}$, $R$ je náhodné èíslo z mno¾iny $\{1,\dots,d\}$, které zaji¹»uje, ¾e v ka¾dém jedinci alespoò jedna pozice vznikne pomocí první øádky, a $o^i$ a $p_j^i$ znaèí $i$-tou slo¾ku potomka resp. $j$-tého rodièe.

Právì první èást definice zaji¹»uje, ¾e diferenciální evoluce je invariantní vùèi rotacím, posunùm a ¹kálování prohledávaného prostoru a tedy funguje lépe pro neseparabilní a ¹patnì podmínìné funkce. Pro toto chování je velmi dùle¾itá volba parametru $CR$. Pro vysoké hodnoty $CR$ vìt¹í èást jedince vzniká právì pomocí rozdílu dvou rodièù, pro nízké hodnoty $CR$ naopak je vìt¹ina jedince tvoøena rodièem $p_4$. Parametr $CR$ se doporuèuje nastavovat na ni¾¹í hodnoty ($CR=0.2$) pro separabilní funkce a na vy¹¹í hodnoty pro neseparabilní funkce ($CR=0.9$). 

Parametr $F$ urèuje, jak velká èást rozdílu dvou jedincù se pou¾ije a tedy i to, jak velké se pøi mutaci dìlají kroky. Nejèastìji se doporuèuje hodnota okolo $F=0.8$, ale vyskytují se nastavení mezi 0.5 a 2.0. Nìkdy se dokonce $F$ bere jako náhodná hodnota z intervalu $[0.5, 1.0]$. 

Kromì vý¹e uvedeného operátoru se v diferenciální evoluci li¹í i selekce. Nový potomek se porovnává s rodièem $p_4$ a v populaci se nechá jen lep¹í z obou. To je i dùvod, proè se èasto rodiè $p_4$ nevolí náhodnì.

V prùbìhu let vznikl systém pro klasifikaci rùzných variant diferenciální evoluce, popsaná verze se dnes nazývá \de{rand}{1}{bin}. Oznaèení vyjadøuje, ¾e se jedná o diferenciální evoluci, kde jsou rodiè $p_3$ pro mutaci je volen náhodnì, vybírá se jedna dvojice a pou¾ívá se binomiální køí¾ení. Existuje ale mnoho dal¹ích variant\cite{Mezura-Montes:2006:CSD:1143997.1144086}. Napøíklad se místo náhodnì zvoleného jedince $p_3$ bere v¾dy nejlep¹í jedinec z populace (\de{best}{.}{.}) nebo se bere více dvojic pøi mutaci. Pro $k$ dvojic potom vypadá operátor v diferenciální evoluci typu \de{.}{k}{.} jako
$$o^i = \twopartdefotherwise{p_3^i + F\sum_{i=1}^k(p_{1,k}^i-p_{2,k}^i)}{r^i < CR \text{ nebo } i = R}
                   {p_4^i}{\,,}$$
kde znaèení je stejné jako vý¹e. 

Místo binomiálního køí¾ení se obèas pou¾ívá tzv. \emph{exponenciální køí¾ení}. To pou¾ívá stejný parametr $CR$, ale jiným zpùsobem. Jedná se vlastnì o obdobu jedno- nebo dvou-bodového køí¾ení. Zaène se na náhodné pozici v jedinci a kopírují se parametry z druhého jedince, dokud je náhodnì zvolené èíslo z $\uniform{0}{1}$ men¹í ne¾ $CR$. Pokud se narazí døíve na konec vektoru, pokraèuje se znovu od zaèátku. Varianta s tímto køí¾ením se nazývá \de{.}{.}{exp} a aèkoliv je velmi oblíbená, vyslou¾ila si v poslední dobì kritiku\cite{Tanabe2014} kvùli tomu, ¾e v køí¾ení je vìt¹í pravdìpodobnost, ¾e se pøekopírují hodnoty, které jsou na sousedních pozicích, a kvùli tomu je algoritmus závislý na poøadí promìnných.
